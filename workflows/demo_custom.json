{
    "name": "dbt-demo workflow - custom profile - DBT_ACCESS_TOKEN",
    "email_notifications": {
        "no_alert_for_skipped_runs": false
    },
    "webhook_notifications": {},
    "timeout_seconds": 0,
    "max_concurrent_runs": 1,
    "tasks": [
        {
            "task_key": "pre_dbt",
            "notebook_task": {
                "notebook_path": "notebooks/check_env_vars",
                "source": "GIT"
            },
            "job_cluster_key": "dbt_CLI",
            "timeout_seconds": 0,
            "email_notifications": {}
        },
        {
            "task_key": "dbt",
            "depends_on": [
                {
                    "task_key": "pre_dbt"
                }
            ],
            "dbt_task": {
                "project_directory": "demo",
                "commands": [
                    "dbt deps",
                    "dbt debug --profiles-dir profiles/demo",
                    "dbt run-operation --args '{variable_name: DBT_ACCESS_TOKEN}' debug_env_var",
                    "dbt run-operation --args '{variable_name: DBT_WAREHOUSE_ID}' debug_env_var",
                    "dbt run-operation --args '{variable_name: DBT_HOST}' debug_env_var"
                ],
                "profiles_directory": "profiles/demo"
            },
            "job_cluster_key": "dbt_CLI",
            "libraries": [
                {
                    "pypi": {
                        "package": "dbt-databricks>=1.0.0,<2.0.0"
                    }
                }
            ],
            "timeout_seconds": 0,
            "email_notifications": {}
        },
        {
            "task_key": "env_vars",
            "depends_on": [
                {
                    "task_key": "dbt"
                }
            ],
            "notebook_task": {
                "notebook_path": "notebooks/check_env_vars",
                "source": "GIT"
            },
            "job_cluster_key": "dbt_CLI",
            "timeout_seconds": 0,
            "email_notifications": {}
        },
        {
            "task_key": "profiles",
            "depends_on": [
                {
                    "task_key": "dbt"
                }
            ],
            "notebook_task": {
                "notebook_path": "notebooks/check_profiles",
                "source": "GIT"
            },
            "job_cluster_key": "dbt_CLI",
            "timeout_seconds": 0,
            "email_notifications": {}
        }
    ],
    "job_clusters": [
        {
            "job_cluster_key": "dbt_CLI",
            "new_cluster": {
                "cluster_name": "",
                "spark_version": "11.3.x-scala2.12",
                "spark_conf": {
                    "spark.master": "local[*, 4]",
                    "spark.databricks.cluster.profile": "singleNode"
                },
                "aws_attributes": {
                    "first_on_demand": 1,
                    "availability": "SPOT_WITH_FALLBACK",
                    "zone_id": "us-west-2a",
                    "spot_bid_price_percent": 100,
                    "ebs_volume_type": "GENERAL_PURPOSE_SSD",
                    "ebs_volume_count": 3,
                    "ebs_volume_size": 100
                },
                "node_type_id": "m4.large",
                "driver_node_type_id": "m4.large",
                "custom_tags": {
                    "ResourceClass": "SingleNode"
                },
                "spark_env_vars": {
                    "HOST": "YOUR_HOST",
                    "CATALOG": "YOUR_CATALOG",
                    "HTTP_PATH": "YOUR_HTTP_PATH",
                    "PAT_TOKEN": "YOUR_PAT_TOKEN",
                    "PYSPARK_PYTHON": "/databricks/python3/bin/python3"
                },
                "enable_elastic_disk": false,
                "data_security_mode": "SINGLE_USER",
                "runtime_engine": "STANDARD",
                "num_workers": 0
            }
        }
    ],
    "git_source": {
        "git_url": "YOUR_GIT_URL",
        "git_provider": "YOUR_GIT_PROVIDER",
        "git_branch": "YOUR_BRANCH"
    },
    "format": "MULTI_TASK"
}